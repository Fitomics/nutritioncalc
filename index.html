<!DOCTYPE html>
<html>
<head>
  <title>Nutrition and Fitness Plan</title>
  <style>
    .placeholder {
      background-color: #ffcccc; /* Light red */
    }
    .calculated {
      background-color: #ccffcc; /* Light green */
    }
  </style>
</head>
<body>
  <h1>Nutrition and Fitness Plan</h1>

  <form>
    <label for="height">Enter Age (Years):</label>
    <input type="number" id="age" name="age"><br><br>

    <label for="gender">Select Gender:</label>
    <select id="gender" name="gender">
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select><br><br>

    <label for="height">Enter Height (Inches):</label>
    <input type="number" id="height" name="height"><br><br>

    <label for="weight">Enter Weight (Pounds):</label>
    <input type="number" id="weight" name="weight"><br><br>

    <label for="bodyfat">Enter Body Fat %:</label>
    <input type="number" id="bodyfat" name="bodyfat"><br><br>

    <!-- New calculated fields with placeholder class -->
    <label for="fat_mass">Fat Mass (lbs):</label>
    <input type="number" id="fat_mass" name="fat_mass" class="placeholder" readonly><br><br>

    <label for="fat_free_mass">Fat-Free Mass (lbs):</label>
    <input type="number" id="fat_free_mass" name="fat_free_mass" class="placeholder" readonly><br><br>

    <label for="fat_mass_index">Fat Mass Index (kg/m^2):</label>
    <input type="number" id="fat_mass_index" name="fat_mass_index" class="placeholder" readonly><br><br>

    <label for="fat_free_mass_index">Fat-Free Mass Index (kg/m^2):</label>
    <input type="number" id="fat_free_mass_index" name="fat_free_mass_index" class="placeholder" readonly><br><br>

    <label for="bmi">Body Mass Index (kg/m^2):</label>
    <input type="number" id="bmi" name="bmi" class="placeholder" readonly><br><br>

    <label for="rmr">Estimated Resting Metabolic Rate (RMR):</label>
    <input type="text" id="rmr" class="placeholder" readonly><br><br>

    <label for="activity">Activity Status: </label>
    <select id="activity" name="activity">
        <option value="sedentary">Sedentary</option>
        <option value="light">Light Active</option>
        <option value="active">Active</option>
        <option value="labor">Labor Intensive</option>
    </select><br><br>

    <label for="workout_calories">Enter Average Calories Expended During a Workout:</label>
    <input type="number" id="workout_calories" name="workout_calories"><br><br>

    <label for="workouts_per_week">Enter Average Workouts Per Week:</label>
    <input type="number" id="workouts_per_week" name="workouts_per_week"><br><br>

    <label for="goal">Goal: </label>
    <select id="goal" name="goal">
        <option value="maintenance">Maintenance</option>
        <option value="fatloss">Fat Loss</option>
        <option value="muscle">Muscle Gain</option>
    </select><br><br>

    <h2>Results:</h2>
    <p>Target Energy Range (kcal): <span id="target_energy"></span></p>
    <p>Protein (grams): <span id="protein"></span></p>
    <p>Fat (grams): <span id="fat"></span></p>
    <p>Carbs (grams): <span id="carbs"></span></p>
    <p>Fiber (grams): <span id="fiber"></span></p>
    <p>Fluid (ounces): <span id="fluid"></span></p>
  </form>

  <script>
    document.getElementById('bodyfat').addEventListener('input', calculateValues);
    document.getElementById('weight').addEventListener('input', calculateValues);
    document.getElementById('height').addEventListener('input', calculateValues);
    document.getElementById('age').addEventListener('input', calculateValues);
    document.getElementById('gender').addEventListener('change', calculateValues);

    function calculateValues() {
      const age = parseFloat(document.getElementById('age').value);
      const weight = parseFloat(document.getElementById('weight').value);
      const bodyFat = parseFloat(document.getElementById('bodyfat').value);
      const height = parseFloat(document.getElementById('height').value);
      const gender = document.getElementById('gender').value;

      if (!isNaN(weight) && !isNaN(bodyFat) && !isNaN(height) && !isNaN(age)) {
        const fatMass = (bodyFat / 100) * weight;
        const fatFreeMass = weight - fatMass;

        document.getElementById('fat_mass').value = fatMass.toFixed(2);
        document.getElementById('fat_free_mass').value = fatFreeMass.toFixed(2);

        document.getElementById('fat_mass').classList.remove('placeholder');
        document.getElementById('fat_mass').classList.add('calculated');
        document.getElementById('fat_free_mass').classList.remove('placeholder');
        document.getElementById('fat_free_mass').classList.add('calculated');

        // Store these calculated variables for later use
        const weightkg = weight / 2.204;
        const heightcm = height * 2.53;

        const heightm = heightcm / 100;
        const fatMassIndex = (weightkg * (bodyFat / 100)) / (heightm * heightm);
        const fatFreeMassIndex = (weightkg * (1 - bodyFat / 100)) / (heightm * heightm);
        const bmi = weightkg / (heightm * heightm);
        
        let rmr;
        if (gender === 'male') {
          rmr = 10 * weightkg + 6.25 * heightcm - 5 * age + 5;
        } else {
          rmr = 10 * weightkg + 6.25 * heightcm - 5 * age - 161;
        }

        document.getElementById('fat_mass_index').value = fatMassIndex.toFixed(2);
        document.getElementById('fat_free_mass_index').value = fatFreeMassIndex.toFixed(2);
        document.getElementById('bmi').value = bmi.toFixed(2);
        document.getElementById('rmr').value = rmr.toFixed(2);

        document.getElementById('fat_mass_index').classList.remove('placeholder');
        document.getElementById('fat_mass_index').classList.add('calculated');
        document.getElementById('fat_free_mass_index').classList.remove('placeholder');
        document.getElementById('fat_free_mass_index').classList.add('calculated');
        document.getElementById('bmi').classList.remove('placeholder');
        document.getElementById('bmi').classList.add('calculated');
        document.getElementById('rmr').classList.remove('placeholder');
        document.getElementById('rmr').classList.add('calculated');

        console.log('Weight (kg):', weightkg);
        console.log('Height (cm):', heightcm);
      }
    }

    // Add event listener to render calculated values when form fields are completed
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('blur', calculateValues);
    });
  </script>
</body>
</html>